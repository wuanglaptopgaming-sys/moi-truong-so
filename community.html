
<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>C·ªông ƒë·ªìng h·ªçc t·∫≠p</title>
<style>
body {font-family: Arial, sans-serif; background: #f6f9ff; margin: 0; padding: 0;}
header {background: #1976d2; color: #fff; padding: 12px 24px; display: flex; justify-content: space-between; align-items: center;}
h1 {margin: 0; font-size: 22px;}
.container {max-width: 800px; margin: 20px auto; background: white; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); padding: 20px;}
#postForm {display: flex; flex-direction: column; gap: 10px;}
#postForm textarea {width: 100%; height: 100px; resize: none; padding: 8px;}
#postForm input[type=file] {padding: 6px;}
.post {border-top: 1px solid #ddd; padding: 12px 0;}
.files-area img {max-width: 100%; border-radius: 8px; margin-top: 6px;}
.files-area video {max-width: 100%; border-radius: 8px; margin-top: 6px;}
.files-area a {display: block; margin-top: 6px; color: #1976d2; text-decoration: none;}
.comment-section {margin-top: 10px; padding-left: 20px;}
.comment {background: #f0f4ff; margin-top: 6px; padding: 6px 10px; border-radius: 8px;}
.comment .files-area img, .comment .files-area video {max-width: 90%; margin-top: 4px;}
</style>
</head>
<body>
<header>
<h1>C·ªông ƒë·ªìng h·ªçc t·∫≠p</h1>
</header>
<div class="container">
  <form id="postForm">
    <textarea id="postContent" placeholder="Chia s·∫ª ƒëi·ªÅu g√¨ ƒë√≥..."></textarea>
    <input id="postFiles" type="file" multiple accept="image/*,video/*,.pdf,.doc,.docx,.ppt,.pptx,.xls,.xlsx,.zip,.rar,.txt">
    <button type="button" id="submitPost">ƒêƒÉng b√†i</button>
  </form>
  <div id="posts"></div>
</div>
<script>
const postsDiv = document.getElementById('posts');
const postBtn = document.getElementById('submitPost');

function getPosts(){return JSON.parse(localStorage.getItem('posts')||'[]');}
function savePosts(p){localStorage.setItem('posts',JSON.stringify(p));}

function renderPosts(){
  postsDiv.innerHTML='';
  const posts=getPosts().reverse();
  posts.forEach((p,idx)=>{
    const div=document.createElement('div');div.className='post';
    div.innerHTML='<p>'+p.text+'</p>';
    const farea=document.createElement('div');farea.className='files-area';
    (p.files||[]).forEach(f=>{
      if(f.type.startsWith('image/')){
        const img=document.createElement('img');img.src=f.url;farea.appendChild(img);
      } else if(f.type.startsWith('video/')){
        const vid=document.createElement('video');vid.src=f.url;vid.controls=true;farea.appendChild(vid);
      } else {
        const a=document.createElement('a');a.href=f.url;a.download=f.name;a.textContent='üìé '+f.name;farea.appendChild(a);
      }
    });
    div.appendChild(farea);
    const cform=document.createElement('div');
    cform.innerHTML='<div class="comment-section"><input type="file" class="commentFiles" multiple accept="image/*,video/*,.pdf,.doc,.docx,.ppt,.pptx,.xls,.xlsx,.zip,.rar,.txt"><input type="text" class="commentText" placeholder="Vi·∫øt b√¨nh lu·∫≠n..."><button class="addComment">G·ª≠i</button><div class="comments"></div></div>';
    div.appendChild(cform);
    postsDiv.appendChild(div);
    renderComments(idx, div.querySelector('.comments'));
    div.querySelector('.addComment').onclick=()=>{
      const txt=div.querySelector('.commentText').value.trim();
      const files=div.querySelector('.commentFiles').files;
      if(!txt && files.length==0)return;
      const fileArr=[];
      for(let f of files){fileArr.push({name:f.name,type:f.type,url:URL.createObjectURL(f)});}
      p.comments.push({text:txt,files:fileArr});
      const arr=getPosts();arr[posts.length-1-idx]=p;savePosts(arr);renderPosts();
    };
  });
}
function renderComments(postIndex, container){
  const posts=getPosts();const post=posts[postIndex];container.innerHTML='';
  (post.comments||[]).forEach(c=>{
    const d=document.createElement('div');d.className='comment';d.innerHTML='<p>'+c.text+'</p>';
    const farea=document.createElement('div');farea.className='files-area';
    (c.files||[]).forEach(f=>{
      if(f.type.startsWith('image/')){const img=document.createElement('img');img.src=f.url;farea.appendChild(img);}
      else if(f.type.startsWith('video/')){const vid=document.createElement('video');vid.src=f.url;vid.controls=true;farea.appendChild(vid);}
      else {const a=document.createElement('a');a.href=f.url;a.download=f.name;a.textContent='üìé '+f.name;farea.appendChild(a);}
    });
    d.appendChild(farea);
    container.appendChild(d);
  });
}
postBtn.onclick=()=>{
  const text=document.getElementById('postContent').value.trim();
  const files=document.getElementById('postFiles').files;
  if(!text && files.length==0)return alert('Vui l√≤ng nh·∫≠p n·ªôi dung ho·∫∑c ch·ªçn t·ªáp');
  const fileArr=[];
  for(let f of files){fileArr.push({name:f.name,type:f.type,url:URL.createObjectURL(f)});}
  const posts=getPosts();posts.push({text,files:fileArr,comments:[]});savePosts(posts);
  document.getElementById('postContent').value='';document.getElementById('postFiles').value='';
  renderPosts();
};
renderPosts();
</script>
</body>
</html>
