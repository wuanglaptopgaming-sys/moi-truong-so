<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Môi Trường Số Học Tập</title>
<style>
  :root{
    --accent:#0072ff; --accent-2:#00c6ff; --muted:#6b7280;
    --bg:#f9fafb; --card:#fff;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,Segoe UI,Arial,sans-serif;background:var(--bg);color:#1f2937}
  header{
    background:var(--card);
    display:flex;align-items:center;justify-content:space-between;
    padding:12px 28px;border-bottom:1px solid #e6eef8;position:sticky;top:0;z-index:30;
  }
  .brand{display:flex;align-items:center;gap:12px}
  .brand .logo{
    width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;
    color:#fff;font-weight:700;background:linear-gradient(135deg,var(--accent-2),var(--accent))
  }
  .brand .title{line-height:1}
  .brand .title h1{margin:0;font-size:17px}
  .brand .title p{margin:0;font-size:12px;color:var(--muted)}
  nav{display:flex;align-items:center;gap:10px}
  nav a, nav button{font-weight:600;background:transparent;border:0;padding:8px 12px;border-radius:8px;cursor:pointer;color:#1f2937;text-decoration:none}
  nav a:hover, nav button:hover{background:#f1f5f9}
  .btn-primary{background:var(--accent);color:#fff}
  .btn-primary:hover{background:#005bd1}

  .intro-section{width:100%;background:linear-gradient(135deg,#eef5ff,#ffffff);padding:48px 60px;display:flex;gap:36px;align-items:center}
  .intro-text{flex:1}
  .intro-text h1{font-size:36px;color:#1a73e8;margin:0 0 8px}
  .intro-text p{color:#444;line-height:1.7;margin:0 0 16px}
  .intro-image{flex:1;display:flex;align-items:center;justify-content:center}
  .intro-image img{width:100%;max-width:520px;border-radius:16px;box-shadow:0 8px 30px rgba(0,0,0,0.08)}

  #userPanel{position:fixed;top:0;right:-380px;width:380px;height:100%;background:var(--card);border-left:1px solid #e6eef8;box-shadow:-8px 0 30px rgba(2,6,23,0.08);transition:right .28s ease;z-index:60;display:flex;flex-direction:column}
  #userPanel.open{right:0}
  #userPanel header{background:var(--accent);color:#fff;padding:14px;display:flex;justify-content:space-between;align-items:center}
  .user-info{padding:16px;overflow-y:auto;flex:1}
  .avatar-area{text-align:center;margin-bottom:8px}
  .avatar-area img{width:110px;height:110px;border-radius:50%;object-fit:cover;border:4px solid transparent;background:linear-gradient(white,white) padding-box,linear-gradient(135deg,#6ce0ff,#5d74ff) border-box}
  .friend-section{padding:12px;border-top:1px solid #eef5ff}
  .friend-item{display:flex;align-items:center;gap:10px;padding:8px;border-radius:8px;background:#f8fafc;margin-bottom:8px}
  .invite-row{display:flex;justify-content:space-between;align-items:center;padding:8px;margin-bottom:8px;border-radius:8px;background:#f8fafc}
</style>
</head>
<body>

<header>
  <div class="brand">
    <div class="logo">ED</div>
    <div class="title">
      <h1>Môi Trường Số Học Tập</h1>
      <p>Học — Chia sẻ — Kết nối</p>
    </div>
  </div>
  <nav id="nav">
    <a href="community.html">Cộng đồng</a>
    <a href="groups.html">Nhóm học tập</a>
    <button id="btn-signup">Đăng ký</button>
    <button id="btn-login" class="btn-primary">Đăng nhập</button>
  </nav>
</header>

<main class="intro-section">
  <div class="intro-text">
    <h1>🎓 Môi Trường Số Học Tập</h1>
    <p>Không gian dành cho sinh viên để chia sẻ bài tập, hỏi đáp, kết nối và cùng nhau tiến bộ.</p>
    <a href="community.html"><button style="padding:10px 18px;border-radius:30px;border:0;background:var(--accent);color:#fff">Vào cộng đồng</button></a>
  </div>
  <div class="intro-image"><img src="https://cdn0986.cdn4s.com/media/2021/01/truong_hoc_truc_tuyen.jpg" alt=""></div>
</main>

<!-- Bảng thông tin người dùng -->
<!-- User Panel (off-canvas right) -->
<div id="userPanel" aria-hidden="true">
  <header>
    <span>Thông tin người dùng</span>
    <button id="closeUserPanel" aria-label="Đóng">&times;</button>
  </header>

  <div class="user-info">
    <div class="avatar-area">
      <img id="avatarPreview" alt="Avatar">
      <div class="small-note">Ảnh đại diện</div>
      <input id="infoAvatar" type="file" accept="image/*" style="display:none">
      <div style="margin-top:8px">
        <button id="changeAvatarBtn" style="padding:8px 10px;border-radius:8px;border:0;background:#eee;cursor:pointer">Đổi ảnh</button>
      </div>
    </div>

    <label>Tên người dùng</label>
    <input id="infoName" type="text" disabled>

    <label>ID</label>
    <input id="infoID" type="text" disabled>

    <label>Ngày sinh</label>
    <input id="infoDOB" type="date">

    <label>Email</label>
    <input id="infoEmail" type="email" placeholder="you@example.com">

    <label>Mô tả</label>
    <textarea id="infoDesc" placeholder="Giới thiệu về bản thân..."></textarea>

    <button id="saveUserInfo" class="save-btn">Lưu thông tin</button>

    <div class="friend-section">
      <h4 style="margin:0 0 8px">Kết bạn</h4>
      <div class="friend-actions">
        <input id="friendSearchSidebar" placeholder="Tìm theo tên hoặc ID...">
        <button id="friendSearchBtn">Tìm</button>
        <button id="friendMailBtn" title="Hộp thư lời mời" style="width:40px;border-radius:8px;background:var(--accent);color:#fff;border:0">📩</button>
      </div>

      <div id="friendInvites" style="display:none;margin-top:10px">
        <!-- invites inserted here -->
      </div>

      <div class="friend-list" id="friendListArea" style="margin-top:10px">
        <!-- friends inserted here -->
      </div>
    </div>
  </div>
</div>



<!-- Modal đăng nhập / đăng ký -->
<div id="modalLogin" style="display:none">
  <div style="position:fixed;inset:0;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center">
    <div style="background:white;padding:20px;border-radius:10px;max-width:400px;width:100%">
      <h3>Đăng nhập</h3>
      <input id="loginUser" placeholder="Tên đăng nhập"><br>
      <input id="loginPass" type="password" placeholder="Mật khẩu"><br>
      <div id="loginError" style="color:red;display:none"></div>
      <button id="submitLogin">Đăng nhập</button>
      <button id="toSignupFromLogin">Chưa có tài khoản?</button>
      <button id="closeLogin">Đóng</button>
    </div>
  </div>
</div>

<div id="modalSignup" style="display:none">
  <div style="position:fixed;inset:0;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center">
    <div style="background:white;padding:20px;border-radius:10px;max-width:400px;width:100%">
      <h3>Đăng ký</h3>
      <input id="signupUser" placeholder="Tên đăng nhập"><br>
      <input id="signupPass" type="password" placeholder="Mật khẩu"><br>
      <div id="signupError" style="color:red;display:none"></div>
      <button id="submitSignup">Đăng ký</button>
      <button id="toLoginFromSignup">Đã có tài khoản?</button>
      <button id="closeSignup">Đóng</button>
    </div>
  </div>
</div>

<script>
const $ = s=>document.querySelector(s);
function getUsers(){return JSON.parse(localStorage.getItem('users')||'[]');}
function saveUsers(a){localStorage.setItem('users',JSON.stringify(a));}
const DEFAULT_AVATAR='https://i.imgur.com/6VBx3io.png';
const navEl=document.getElementById('nav');

function resetNav(){
  navEl.innerHTML=`
    <a href="community.html">Cộng đồng</a>
    <a href="groups.html">Nhóm học tập</a>
    <button id="btn-signup">Đăng ký</button>
    <button id="btn-login" class="btn-primary">Đăng nhập</button>`;
  $('#btn-login').onclick=()=>modalLogin.style.display='block';
  $('#btn-signup').onclick=()=>modalSignup.style.display='block';
}

function renderNav(){
  const u=localStorage.getItem('username');
  if(!u){resetNav();return;}
  const users=getUsers(); const me=users.find(x=>x.username===u);
  const av=(me&&me.avatar)?me.avatar:DEFAULT_AVATAR;
  navEl.innerHTML=`
    <a href="community.html">Cộng đồng</a>
    <a href="groups.html">Nhóm học tập</a>
    <img id="navAvatar" src="${av}" style="width:36px;height:36px;border-radius:50%;object-fit:cover;cursor:pointer">
    <span>Xin chào, <strong id="nav-user">${u}</strong></span>
    <button id="logoutBtn">Đăng xuất</button>`;
  $('#logoutBtn').onclick=()=>{localStorage.removeItem('username');renderNav();};
  $('#navAvatar').onclick=()=>{userPanel.classList.add('open');showUserInfo();};
  $('#nav-user').onclick=()=>{userPanel.classList.add('open');showUserInfo();};
}

const modalLogin=$('#modalLogin'),modalSignup=$('#modalSignup');
$('#closeLogin').onclick=()=>modalLogin.style.display='none';
$('#closeSignup').onclick=()=>modalSignup.style.display='none';
$('#toSignupFromLogin').onclick=()=>{modalLogin.style.display='none';modalSignup.style.display='block';};
$('#toLoginFromSignup').onclick=()=>{modalSignup.style.display='none';modalLogin.style.display='block';};

$('#submitSignup').onclick=()=>{
  const u=$('#signupUser').value.trim(),p=$('#signupPass').value;
  const err=$('#signupError');
  if(!u||!p){err.textContent='Điền đủ thông tin';err.style.display='block';return;}
  if(p.length<8||p.length>16){err.textContent='Mật khẩu 8-16 ký tự';err.style.display='block';return;}
  const arr=getUsers();
  if(arr.some(x=>x.username.toLowerCase()===u.toLowerCase())){err.textContent='Tên đã tồn tại';err.style.display='block';return;}
  arr.push({username:u,password:p,id:'#'+(1000+arr.length+1),avatar:null,dob:'',email:'',desc:'',friends:[]});
  saveUsers(arr);localStorage.setItem('username',u);modalSignup.style.display='none';renderNav();
};

$('#submitLogin').onclick=()=>{
  const u=$('#loginUser').value.trim(),p=$('#loginPass').value;const err=$('#loginError');
  const arr=getUsers();const f=arr.find(x=>x.username===u&&x.password===p);
  if(!f){err.textContent='Sai thông tin';err.style.display='block';return;}
  localStorage.setItem('username',u);modalLogin.style.display='none';renderNav();
};

/* user panel info */
const userPanel=$('#userPanel');$('#closeUserPanel').onclick=()=>userPanel.classList.remove('open');
function showUserInfo(){
  const u=localStorage.getItem('username');const arr=getUsers();const me=arr.find(x=>x.username===u);
  $('#avatarPreview').src=(me&&me.avatar)||DEFAULT_AVATAR;
  $('#infoName').value=me?me.username:'Chưa đăng nhập';
  $('#infoID').value=me?me.id:'Ẩn';
  $('#infoDOB').value=me?me.dob:'';$('#infoEmail').value=me?me.email:'';$('#infoDesc').value=me?me.desc:'';
}
$('#changeAvatarBtn').onclick=()=>$('#infoAvatar').click();
$('#infoAvatar').onchange=e=>{
  const f=e.target.files[0];if(!f)return;const r=new FileReader();
  r.onload=v=>{
    const u=localStorage.getItem('username');const arr=getUsers();const me=arr.find(x=>x.username===u);
    if(me){me.avatar=v.target.result;saveUsers(arr);renderNav();$('#avatarPreview').src=v.target.result;}
  };r.readAsDataURL(f);
};
$('#saveUserInfo').onclick=()=>{
  const u=localStorage.getItem('username');const arr=getUsers();const me=arr.find(x=>x.username===u);
  if(me){me.dob=$('#infoDOB').value;me.email=$('#infoEmail').value;me.desc=$('#infoDesc').value;saveUsers(arr);alert('Đã lưu!');}
};

function init(){renderNav();}
init();
</script>
</body>
</html>

