<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Môi Trường Số Học Tập</title>
  <style>
    :root{
      --accent:#0072ff; --accent-2:#00c6ff; --muted:#6b7280;
      --bg:#f9fafb; --card:#fff;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,Segoe UI,Arial,sans-serif;background:var(--bg);color:#1f2937;overflow-x:hidden}
    header{background:var(--card);display:flex;align-items:center;justify-content:space-between;padding:12px 28px;border-bottom:1px solid #e6eef8;position:sticky;top:0;z-index:30}
    .brand{display:flex;align-items:center;gap:12px}
    .brand .logo{width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;background:linear-gradient(135deg,var(--accent-2),var(--accent))}
    .brand .title{line-height:1}
    .brand .title h1{margin:0;font-size:17px}
    .brand .title p{margin:0;font-size:12px;color:var(--muted)}
    nav{display:flex;align-items:center;gap:10px}
    nav a, nav button{font-weight:600;background:transparent;border:0;padding:8px 12px;border-radius:8px;cursor:pointer;color:#1f2937;text-decoration:none}
    nav a:hover, nav button:hover{background:#f1f5f9}
    .btn-primary{background:var(--accent);color:#fff}
    .btn-primary:hover{background:#005bd1}
    main{padding:40px;min-height:60vh;display:flex;align-items:center;justify-content:center}
    .empty{color:var(--muted);font-size:18px}

    /* Modal */
    .modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,0.45);display:flex;align-items:center;justify-content:center;z-index:60}
    .modal{width:100%;max-width:420px;background:var(--card);border-radius:12px;padding:18px;box-shadow:0 12px 40px rgba(2,6,23,0.2)}
    .modal h3{margin:0 0 8px}
    .form-group{margin-top:10px}
    input,textarea{width:100%;padding:10px 12px;border-radius:8px;border:1px solid #e6eef8;font-size:14px}
    .row{display:flex;gap:8px}
    .small{font-size:13px;color:var(--muted);margin-top:8px}
    .actions{display:flex;gap:8px;justify-content:flex-end;margin-top:14px}
    .link{background:transparent;border:0;color:var(--accent);cursor:pointer;padding:8px;border-radius:8px}
    .error{color:#b91c1c;font-size:13px;margin-top:8px}
    @media(max-width:520px){header{padding:10px 14px}.brand .title h1{font-size:15px}}

    /* Sidebar user info */
    #userPanel{
      position:fixed;top:0;right:-400px;width:340px;height:100vh;
      background:var(--card);box-shadow:-2px 0 10px rgba(0,0,0,0.1);
      border-top-left-radius:12px;border-bottom-left-radius:12px;
      transition:right 0.4s ease;z-index:50;padding:20px;overflow-y:auto;
    }
    #userPanel.open{right:0;}
    #userPanel h3{margin-top:0}
    #togglePanelBtn{margin-left:8px;background:var(--accent);color:#fff;border:none;border-radius:8px;padding:8px 12px;cursor:pointer}
    #togglePanelBtn:hover{background:#005bd1}
    #friendBox{margin-top:20px;padding:10px;border:1px solid #e6eef8;border-radius:10px;background:#f9fafb}
    #friendRequests{margin-top:10px;font-size:14px;color:var(--muted)}
    #friendList{margin-top:10px}
    .friend-item{padding:6px 0;border-bottom:1px solid #eee}
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo">ED</div>
      <div class="title">
        <h1>Môi Trường Số Học Tập</h1>
        <p>Học — Chia sẻ — Kết nối</p>
      </div>
    </div>

    <nav id="nav">
      <a href="#">Tính năng</a>
      <a href="#">Khóa học</a>
      <a href="community.html">Cộng đồng</a>
      <button id="btn-signup">Đăng ký</button>
      <button id="btn-login" class="btn-primary">Đăng nhập</button>
    </nav>
  </header>

  <main>
    <div class="empty">Trang chủ đang rỗng — bạn có thể thêm nội dung tại đây.</div>
  </main>

  <!-- Login Modal -->
  <div id="modalLogin" style="display:none">
    <div class="modal-backdrop">
      <div class="modal">
        <h3>Đăng nhập</h3>
        <div class="form-group">
          <label>Tên đăng nhập</label>
          <input id="loginUser" type="text" placeholder="Nhập tên đăng nhập">
        </div>
        <div class="form-group">
          <label>Mật khẩu</label>
          <input id="loginPass" type="password" placeholder="Nhập mật khẩu">
        </div>
        <div id="loginError" class="error" style="display:none"></div>
        <div class="actions">
          <button class="link" id="toSignupFromLogin">Chưa có tài khoản?</button>
          <button id="closeLogin" class="link">Hủy</button>
          <button id="submitLogin" class="btn-primary">Đăng nhập</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Signup Modal -->
  <div id="modalSignup" style="display:none">
    <div class="modal-backdrop">
      <div class="modal">
        <h3>Đăng ký</h3>
        <div class="form-group">
          <label>Tên đăng nhập</label>
          <input id="signupUser" type="text" placeholder="Chọn tên đăng nhập">
        </div>
        <div class="form-group">
          <label>Mật khẩu (8-16 ký tự)</label>
          <input id="signupPass" type="password" placeholder="Mật khẩu">
        </div>
        <div id="signupError" class="error" style="display:none"></div>
        <div class="actions">
          <button class="link" id="toLoginFromSignup">Đã có tài khoản?</button>
          <button id="closeSignup" class="link">Hủy</button>
          <button id="submitSignup" class="btn-primary">Đăng ký</button>
        </div>
      </div>
    </div>
  </div>

  <!-- User Info Sidebar -->
  <aside id="userPanel">
    <h3>Thông tin người dùng</h3>
    <div class="form-group">
      <label>Tên:</label>
      <input id="userNameField" type="text">
    </div>
    <div class="form-group">
      <label>ID người dùng:</label>
      <input id="userIdField" type="text" readonly>
    </div>
    <div class="form-group">
      <label>Ngày sinh:</label>
      <input id="userDobField" type="date">
    </div>
    <div class="form-group">
      <label>Email:</label>
      <input id="userEmailField" type="email">
    </div>
    <div class="form-group">
      <label>Mô tả:</label>
      <textarea id="userDescField" rows="3" placeholder="Giới thiệu bản thân..."></textarea>
    </div>
    <div class="actions">
      <button id="saveUserInfo" class="btn-primary">Lưu thông tin</button>
    </div>
    <div id="friendBox">
      <h4>Kết bạn</h4>
      <input id="friendSearch" type="text" placeholder="Nhập tên hoặc ID...">
      <button id="addFriendBtn" class="btn-primary" style="margin-top:8px;width:100%">Kết bạn</button>
      <div id="friendRequests">
        <h5>Lời mời kết bạn</h5>
        <div id="friendList"></div>
      </div>
    </div>
  </aside>

<script>
  const $ = s=>document.querySelector(s);
  const show = el=>{el.style.display='block'}
  const hide = el=>{el.style.display='none'}

  const modalLogin=$('#modalLogin'), modalSignup=$('#modalSignup');
  const btnLogin=$('#btn-login'), btnSignup=$('#btn-signup'), navEl=$('#nav');
  const userPanel=$('#userPanel');
  let toggleBtn;

  btnLogin.onclick=()=>{show(modalLogin);$('#loginUser').focus();}
  btnSignup.onclick=()=>{show(modalSignup);$('#signupUser').focus();}
  $('#closeLogin').onclick=()=>hide(modalLogin);
  $('#closeSignup').onclick=()=>hide(modalSignup);
  $('#toSignupFromLogin').onclick=()=>{hide(modalLogin);show(modalSignup);}
  $('#toLoginFromSignup').onclick=()=>{hide(modalSignup);show(modalLogin);}

  // Random ID generator
  function randomId(){return '#'+Math.floor(1000+Math.random()*9000)}

  // Local storage
  function getUsers(){return JSON.parse(localStorage.getItem('users')||'[]')}
  function saveUsers(u){localStorage.setItem('users',JSON.stringify(u))}

  // Signup
  $('#submitSignup').onclick=()=>{
    const u=$('#signupUser').value.trim(), p=$('#signupPass').value, err=$('#signupError');
    err.style.display='none';
    if(!u||!p){err.textContent='Vui lòng điền đủ thông tin.';err.style.display='block';return;}
    if(p.length<8||p.length>16){err.textContent='Mật khẩu phải từ 8–16 ký tự.';err.style.display='block';return;}
    const users=getUsers();
    if(users.find(x=>x.username===u)){err.textContent='Tên đăng nhập đã tồn tại.';err.style.display='block';return;}
    const newUser={username:u,password:p,id:randomId(),dob:'',email:'',desc:''};
    users.push(newUser);saveUsers(users);
    localStorage.setItem('username',u);
    alert('Đăng ký thành công!');
    hide(modalSignup);
    updateNav();
  }

  // Login
  $('#submitLogin').onclick=()=>{
    const u=$('#loginUser').value.trim(), p=$('#loginPass').value, err=$('#loginError');
    err.style.display='none';
    const users=getUsers();
    const found=users.find(x=>x.username===u&&x.password===p);
    if(!found){err.textContent='Sai tên đăng nhập hoặc mật khẩu.';err.style.display='block';return;}
    localStorage.setItem('username',u);
    hide(modalLogin);
    updateNav();
  }

  // Update nav for logged user
  function updateNav(){
    const username=localStorage.getItem('username');
    if(!username)return resetNav();
    navEl.innerHTML=`
      <a href="#">Tính năng</a>
      <a href="#">Khóa học</a>
      <a href="community.html">Cộng đồng</a>
      <span>Xin chào, <strong>${username}</strong></span>
      <button id="togglePanelBtn">Hồ sơ</button>
      <button id="logoutBtn" class="link">Đăng xuất</button>
    `;
    $('#logoutBtn').onclick=()=>{localStorage.removeItem('username');resetNav();userPanel.classList.remove('open');}
    toggleBtn=$('#togglePanelBtn');
    toggleBtn.onclick=()=>{userPanel.classList.toggle('open');loadUserInfo();}
    loadUserInfo();
  }

  function resetNav(){
    navEl.innerHTML=`
      <a href="#">Tính năng</a>
      <a href="#">Khóa học</a>
      <a href="community.html">Cộng đồng</a>
      <button id="btn-signup">Đăng ký</button>
      <button id="btn-login" class="btn-primary">Đăng nhập</button>
    `;
    $('#btn-login').onclick=()=>{show(modalLogin);}
    $('#btn-signup').onclick=()=>{show(modalSignup);}
  }

  function loadUserInfo(){
    const username=localStorage.getItem('username');
    if(!username)return;
    const users=getUsers();
    const user=users.find(x=>x.username===username);
    if(user){
      $('#userNameField').value=user.username;
      $('#userIdField').value=user.id;
      $('#userDobField').value=user.dob||'';
      $('#userEmailField').value=user.email||'';
      $('#userDescField').value=user.desc||'';
    }
  }

  $('#saveUserInfo').onclick=()=>{
    const username=localStorage.getItem('username');
    const users=getUsers();
    const idx=users.findIndex(x=>x.username===username);
    if(idx>-1){
      users[idx].dob=$('#userDobField').value;
      users[idx].email=$('#userEmailField').value;
      users[idx].desc=$('#userDescField').value;
      saveUsers(users);
      alert('Đã lưu thông tin!');
    }
  }

  // Init
  (function(){
    if(localStorage.getItem('username')) updateNav();
  })();
</script>
</body>
</html>
